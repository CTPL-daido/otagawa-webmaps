<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="css/leaflet.css">
    <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
    <link rel="stylesheet" href="css/qgis2web.css">
    <link rel="stylesheet" href="css/fontawesome-all.min.css">
    <link rel="stylesheet" href="css/MarkerCluster.css">
    <link rel="stylesheet" href="css/MarkerCluster.Default.css">
    <style>
      #map {
        width: 100%;
        height: 100%;
        left: 0;
        top: 0;
        position: fixed;
      }
    </style>
    <title>地理院タイル 淡色地図付き</title>
  </head>
  <body>
    <div id="map"></div>

    <!-- JavaScript読み込み -->
    <script src="js/qgis2web_expressions.js"></script>
    <script src="js/leaflet.js"></script>
    <script src="js/L.Control.Layers.Tree.min.js"></script>
    <script src="js/leaflet.rotatedMarker.js"></script>
    <script src="js/leaflet.pattern.js"></script>
    <script src="js/leaflet-hash.js"></script>
    <script src="js/Autolinker.min.js"></script>
    <script src="js/rbush.min.js"></script>
    <script src="js/labelgun.min.js"></script>
    <script src="js/labels.js"></script>
    <script src="js/leaflet.markercluster.js"></script>

    <!-- GeoJSONデータ -->
    <script src="data/_1.js"></script>
    <script src="data/gis_2.js"></script>

    <script>
      var map = L.map('map', {
        zoomControl: false,
        maxZoom: 28,
        minZoom: 1
      }).fitBounds([[35.0215, 136.8904], [35.0242, 136.8950]]);

      var hash = new L.Hash(map);
      map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> ・ <a href="https://leafletjs.com">Leaflet</a> ・ <a href="https://qgis.org">QGIS</a>');

      var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
      var bounds_group = new L.featureGroup([]);

      // 地理院タイル：淡色地図
      map.createPane('pane___1');
      map.getPane('pane___1').style.zIndex = 300;
      var layer___1 = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/light-all/{z}/{x}/{y}.png', {
        pane: 'pane___1',
        opacity: 1.0,
        attribution: '<a href="https://maps.gsi.go.jp/development/ichiran.html" target="_blank">地理院タイル</a>',
        minZoom: 1,
        maxZoom: 18,
        minNativeZoom: 2,
        maxNativeZoom: 18
      });

      // 地理院タイル：全国最新写真
      map.createPane('pane_03___0');
      map.getPane('pane_03___0').style.zIndex = 400;
      var layer_03___0 = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg', {
        pane: 'pane_03___0',
        opacity: 1.0,
        attribution: '<a href="https://maps.gsi.go.jp/development/ichiran.html" target="_blank">地理院タイル</a>',
        minZoom: 1,
        maxZoom: 18,
        minNativeZoom: 2,
        maxNativeZoom: 18
      });
      map.addLayer(layer___1); // 淡色地図を初期表示

      // gis点 レイヤー
      function pop_gis_2(feature, layer) {
        var popupContent = '<table>' +
          '<tr><td colspan="2">' + (feature.properties['fid'] || '') + '</td></tr>' +
          '<tr><td colspan="2">' + (feature.properties['URL'] || '') + '</td></tr>' +
          '</table>';
        layer.bindPopup(popupContent, {maxHeight: 400});
      }

      function style_gis_2_0() {
        return {
          pane: 'pane_gis_2',
          radius: 4.0,
          opacity: 1,
          color: 'rgba(35,35,35,1.0)',
          weight: 1,
          fillOpacity: 1,
          fillColor: 'rgba(229,182,54,1.0)',
          interactive: true
        };
      }

      map.createPane('pane_gis_2');
      map.getPane('pane_gis_2').style.zIndex = 402;
      var layer_gis_2 = new L.geoJson(json_gis_2, {
        pane: 'pane_gis_2',
        onEachFeature: pop_gis_2,
        pointToLayer: function (feature, latlng) {
          return L.circleMarker(latlng, style_gis_2_0());
        }
      });

      var cluster_gis_2 = new L.MarkerClusterGroup({showCoverageOnHover: false});
      cluster_gis_2.addLayer(layer_gis_2);
      cluster_gis_2.addTo(map);
      bounds_group.addLayer(layer_gis_2);

      // 枠レイヤー（例）
      function pop__1(feature, layer) {
        var popupContent = '<table>' +
          '<tr><td colspan="2">' + (feature.properties['fid'] || '') + '</td></tr>' +
          '</table>';
        layer.bindPopup(popupContent, {maxHeight: 400});
      }

      function style__1_0() {
        return {
          pane: 'pane__1',
          color: 'rgba(227,26,28,1.0)',
          weight: 11.0,
          fill: false,
          opacity: 1.0,
          interactive: true
        };
      }

      map.createPane('pane__1');
      map.getPane('pane__1').style.zIndex = 401;
      var layer__1 = new L.geoJson(json__1, {
        pane: 'pane__1',
        onEachFeature: pop__1,
        style: style__1_0
      });
      map.addLayer(layer__1);
      bounds_group.addLayer(layer__1);

      // レイヤー切り替えコントロール
      var overlaysTree = [
        {label: '<img src="legend/gis_2.png" /> gis点', layer: cluster_gis_2},
        {label: '<img src="legend/_1.png" /> 枠', layer: layer__1},
        {label: "地理院タイル_淡色地図", layer: layer___1, radioGroup: 'basemaps'},
        {label: "03_全国最新写真（シームレス）", layer: layer_03___0, radioGroup: 'basemaps'}
      ];
      var lay = L.control.layers.tree(null, overlaysTree, {collapsed: true});
      lay.addTo(map);

    </script>
  </body>
</html>